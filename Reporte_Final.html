<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listado de Habitaciones - Dreams Flora Resort & Spa</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Chosen Palette: Emerald & Sand (Nature/Resort Vibe) -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        brand: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            500: '#10b981', // Emerald
                            600: '#059669',
                            900: '#064e3b',
                        },
                        sand: {
                            50: '#fdfbf7',
                            100: '#f7f3e8',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom scrollbar for table container */
        .table-container::-webkit-scrollbar {
            height: 8px;
        }
        .table-container::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        .table-container::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        .table-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        .chart-container {
            position: relative;
            height: 250px; 
            width: 100%;
        }
    </style>
    
    <!-- Application Structure Plan: 
         Simple Dashboard Layout.
         - Header: Branding and Total Cost.
         - Top Section: Key Metrics & Charts (Status & Occupancy).
         - Main Section: Filterable Table with the exact list data.
    -->
</head>
<body class="bg-sand-50 text-slate-800 antialiased min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white border-b border-brand-100 shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="bg-brand-100 text-brand-600 p-2.5 rounded-xl">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                    </svg>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-slate-900 leading-tight">Dreams Flora Resort & Spa</h1>
                    <p class="text-xs text-slate-500 font-medium">Punta Cana • 2 Noches (Tarifa Actualizada)</p>
                </div>
            </div>
            
            <div class="text-right">
                <p class="text-xs text-slate-400 uppercase tracking-wider font-semibold">Total General</p>
                <p class="text-2xl font-bold text-brand-600" id="header-total">$13,528.00</p>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8">

        <!-- Metrics & Charts Section -->
        <!-- Visualization & Content Choices: 
             - Status Donut Chart: Quick view of confirmed vs pending rooms.
             - Occupancy Bar Chart: Breakdown of adults/kids/babies.
             - No SVG used, Canvas charts via Chart.js.
        -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Status Chart -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6 flex flex-col">
                <h3 class="font-bold text-slate-800 mb-4 text-sm uppercase tracking-wide text-center">Estado de Reservas</h3>
                <div class="chart-container flex-grow flex justify-center items-center">
                    <canvas id="statusChart"></canvas>
                </div>
            </div>

            <!-- Occupancy Chart -->
            <div class="bg-white rounded-2xl shadow-sm border border-slate-100 p-6 flex flex-col">
                <h3 class="font-bold text-slate-800 mb-4 text-sm uppercase tracking-wide text-center">Composición de Huéspedes</h3>
                <div class="chart-container flex-grow">
                    <canvas id="occupancyChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Room List Section -->
        <div class="bg-white rounded-xl shadow-sm border border-slate-100 overflow-hidden">
            <!-- Filters -->
            <div class="p-6 border-b border-slate-100 flex flex-col sm:flex-row gap-4 justify-between items-center bg-slate-50/50">
                <div class="relative w-full sm:w-64">
                    <span class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-slate-400">
                        <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
                    </span>
                    <input type="text" id="searchInput" placeholder="Buscar por nombre..." class="pl-10 pr-4 py-2 w-full bg-white border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-brand-500 focus:border-transparent transition shadow-sm">
                </div>
                
                <div class="flex gap-2">
                    <button onclick="filterRooms('all')" class="px-4 py-2 rounded-lg text-sm font-medium bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 focus:ring-2 focus:ring-brand-500 transition active-filter" id="btn-all">Todos</button>
                    <button onclick="filterRooms('CONFIRMADO')" class="px-4 py-2 rounded-lg text-sm font-medium bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 focus:ring-2 focus:ring-brand-500 transition" id="btn-conf">Confirmados</button>
                    <button onclick="filterRooms('Pendiente')" class="px-4 py-2 rounded-lg text-sm font-medium bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 focus:ring-2 focus:ring-brand-500 transition" id="btn-pend">Pendientes</button>
                </div>
            </div>

            <!-- Table -->
            <div class="overflow-x-auto table-container">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-slate-50 text-slate-500 text-xs uppercase tracking-wider font-semibold border-b border-slate-200">
                            <th class="px-6 py-4 w-16 text-center">No.</th>
                            <th class="px-6 py-4">Nombres</th>
                            <th class="px-4 py-4 text-center">Adultos</th>
                            <th class="px-4 py-4 text-center">Niños</th>
                            <th class="px-4 py-4 text-center">Bebés</th>
                            <th class="px-6 py-4 text-right">$/Noche</th>
                            <th class="px-6 py-4 text-right">Total 2N</th>
                            <th class="px-6 py-4 text-center">Estado</th>
                        </tr>
                    </thead>
                    <tbody id="roomsTableBody" class="text-sm divide-y divide-slate-100 text-slate-700 bg-white">
                        <!-- Data rows will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 py-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4 text-center text-slate-400 text-sm">
            <p>&copy; 2025 Gestión de Reservas - Dreams Flora</p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // CONFIRMATION: NO SVG graphics used (Chart.js uses Canvas). NO Mermaid JS used.

        // --- Data Source ---
        // Exactly matching the provided PDF list data, with 1, 4, 6, 7, 8, 9, 10, 13, 14, 15 confirmed.
        const rooms = [
            // HABITACIONES DE 2 PERSONAS (DOBLES)
            { id: 1, section: "DOBLES", names: "Alejandro Henriquez<br>Mildre Papi", adults: 2, kids: 0, babies: 0, costPerNight: 312.00, total: 624.00, status: "CONFIRMADO" }, // CONFIRMADO
            { id: 2, section: "DOBLES", names: "Genesis Henriquez<br>Carlos Genesis", adults: 2, kids: 0, babies: 0, costPerNight: 312.00, total: 624.00, status: "Pendiente" },
            { id: 3, section: "DOBLES", names: "Jose Ramón Rodriguez<br>Yashira Maleno", adults: 2, kids: 0, babies: 0, costPerNight: 312.00, total: 624.00, status: "Pendiente" },
            { id: 4, section: "DOBLES", names: "Maria de los Angeles<br>Altagracia Lavatta", adults: 2, kids: 0, babies: 0, costPerNight: 312.00, total: 624.00, status: "CONFIRMADO" }, // CONFIRMADO
            { id: 5, section: "DOBLES", names: "Nathan Rego - 19<br>Jasmine Soares - 12", adults: 1, kids: 1, babies: 0, costPerNight: 329.00, total: 658.00, status: "Pendiente" },
            { id: 6, section: "DOBLES", names: "Candida Lavatta<br>Daniel Lavatta", adults: 2, kids: 0, babies: 0, costPerNight: 312.00, total: 624.00, status: "CONFIRMADO" }, // CONFIRMADO
            
            // HABITACIONES DE 3 PERSONAS
            { id: 7, section: "TRIPLES", names: "Emmanuel Dominguez<br>Katerine Emmanuel<br>Dominic Dominguez - 2", adults: 2, kids: 0, babies: 1, costPerNight: 312.00, total: 624.00, status: "CONFIRMADO" }, // CONFIRMADO
            { id: 8, section: "TRIPLES", names: "Alejandrito Henriquez<br>Alicia Aleman<br>Sophia Henriquez - 11", adults: 2, kids: 1, babies: 0, costPerNight: 391.00, total: 782.00, status: "CONFIRMADO" }, // CONFIRMADO
            { id: 9, section: "TRIPLES", names: "Marcia Henriquez<br>Stephen Lip<br>Isaac Wilkes - 12", adults: 2, kids: 1, babies: 0, costPerNight: 391.00, total: 782.00, status: "CONFIRMADO" }, // CONFIRMADO
            { id: 10, section: "TRIPLES", names: "Raquel Henriquez<br>Roberto Gonzalez<br>Gabriel Henriquez - 11", adults: 2, kids: 1, babies: 0, costPerNight: 391.00, total: 782.00, status: "CONFIRMADO" }, // CONFIRMADO
            { id: 11, section: "TRIPLES", names: "Luz Lavatta<br>Chencha Lavatta<br>Ina Lavatta", adults: 3, kids: 0, babies: 0, costPerNight: 466.00, total: 932.00, status: "Pendiente" },
            { id: 12, section: "TRIPLES", names: "Dangerys Lazala<br>Carla Patricia Siri<br>Dorían Siri", adults: 3, kids: 0, babies: 0, costPerNight: 466.00, total: 932.00, status: "Pendiente" },
            { id: 13, section: "TRIPLES", names: "Aderly Carela<br>Rainiel Basora<br>Rafael Aleman", adults: 3, kids: 0, babies: 0, costPerNight: 466.00, total: 932.00, status: "CONFIRMADO" }, // CONFIRMADO
            { id: 14, section: "TRIPLES", names: "Sebastian Henriquez<br>Betoven Henriquez<br>Marisol Henriquez", adults: 3, kids: 0, babies: 0, costPerNight: 466.00, total: 932.00, status: "CONFIRMADO" }, // CONFIRMADO
            
            // HABITACIONES DE 4 PERSONAS
            { id: 15, section: "CUÁDRUPLES", names: "Bianca Henriquez<br>Phillip Wilkes<br>Phillip Junior - 14<br>Isabella Wilkes - 12", adults: 3, kids: 1, babies: 0, costPerNight: 545.00, total: 1090.00, status: "CONFIRMADO" }, // CONFIRMADO
            { id: 16, section: "CUÁDRUPLES", names: "Jeanette Henriquez<br>Robert Siri<br>Cesar Amir Benitez - 7<br>Isaac Benitez - 7", adults: 2, kids: 2, babies: 0, costPerNight: 470.00, total: 940.00, status: "Pendiente" },
            { id: 17, section: "CUÁDRUPLES", names: "Miguel Guzman López<br>Natercia Guzman López<br>Mason Guzman López - 9<br>Brianna Soares - 11", adults: 2, kids: 2, babies: 0, costPerNight: 470.00, total: 940.00, status: "Pendiente" }
        ];

        // Formatters
        const currencyFormatter = new Intl.NumberFormat('en-US', {
            style: 'currency',
            currency: 'USD',
            minimumFractionDigits: 2
        });

        // State
        let currentFilter = 'all';
        let searchQuery = '';
        let statusChart = null;
        let occupancyChart = null;

        // --- Core Functions ---

        function init() {
            renderTable();
            renderCharts();
            updateTotalHeader();
        }

        function updateTotalHeader() {
            // Calculate total from data to be dynamic
            const total = rooms.reduce((sum, room) => sum + room.total, 0);
            document.getElementById('header-total').textContent = currencyFormatter.format(total);
        }

        function filterRooms(status) {
            currentFilter = status;
            
            // Update buttons visual state
            const buttons = { 'all': 'btn-all', 'CONFIRMADO': 'btn-conf', 'Pendiente': 'btn-pend' };
            Object.values(buttons).forEach(id => {
                document.getElementById(id).className = "px-4 py-2 rounded-lg text-sm font-medium bg-white border border-slate-200 text-slate-600 hover:bg-slate-50 focus:ring-2 focus:ring-brand-500 transition";
            });
            
            const activeId = buttons[status] || 'btn-all';
            document.getElementById(activeId).className = "px-4 py-2 rounded-lg text-sm font-medium bg-brand-600 text-white border border-transparent shadow-md transition";

            renderTable();
        }

        document.getElementById('searchInput').addEventListener('input', (e) => {
            searchQuery = e.target.value.toLowerCase();
            renderTable();
        });

        function renderTable() {
            const tbody = document.getElementById('roomsTableBody');
            tbody.innerHTML = '';

            const filteredData = rooms.filter(room => {
                const matchesStatus = currentFilter === 'all' || room.status === currentFilter;
                // Simple search on names text (stripping HTML breaks for search)
                const namesText = room.names.replace(/<br>/g, ' ').toLowerCase();
                const matchesSearch = namesText.includes(searchQuery);
                return matchesStatus && matchesSearch;
            });

            if (filteredData.length === 0) {
                tbody.innerHTML = `<tr><td colspan="8" class="px-6 py-8 text-center text-slate-400 italic">No se encontraron resultados.</td></tr>`;
                return;
            }

            let currentSection = '';

            filteredData.forEach(room => {
                // Add Section Header if it changes and we are not filtering by status (to keep list clean)
                // Actually, let's just group them visually if the filter allows.
                if (room.section !== currentSection && currentFilter === 'all' && searchQuery === '') {
                    currentSection = room.section;
                    const sectionTitle = currentSection === 'DOBLES' ? 'HABITACIONES DE 2 PERSONAS (DOBLES)' :
                                         currentSection === 'TRIPLES' ? 'HABITACIONES DE 3 PERSONAS' :
                                         'HABITACIONES DE 4 PERSONAS';
                    
                    const trHeader = document.createElement('tr');
                    trHeader.className = "bg-slate-100";
                    trHeader.innerHTML = `<td colspan="8" class="px-6 py-2 text-xs font-bold text-slate-600 uppercase tracking-wider">${sectionTitle}</td>`;
                    tbody.appendChild(trHeader);
                }

                const tr = document.createElement('tr');
                tr.className = "hover:bg-slate-50 transition border-b border-slate-100 group";
                
                const isConfirmed = room.status === 'CONFIRMADO';
                const statusBadge = isConfirmed 
                    ? `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold bg-green-100 text-green-800 border border-green-200">CONFIRMADO</span>`
                    : `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-50 text-red-700 border border-red-100">Pendiente</span>`;

                tr.innerHTML = `
                    <td class="px-6 py-4 text-center font-medium text-slate-500">${room.id}</td>
                    <td class="px-6 py-4">
                        <div class="text-slate-900 font-medium leading-snug">${room.names}</div>
                    </td>
                    <td class="px-4 py-4 text-center text-slate-600">${room.adults}</td>
                    <td class="px-4 py-4 text-center text-slate-600">${room.kids}</td>
                    <td class="px-4 py-4 text-center text-slate-600">${room.babies}</td>
                    <td class="px-6 py-4 text-right text-slate-500 font-mono">${currencyFormatter.format(room.costPerNight)}</td>
                    <td class="px-6 py-4 text-right font-bold text-slate-800 font-mono">${currencyFormatter.format(room.total)}</td>
                    <td class="px-6 py-4 text-center">${statusBadge}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderCharts() {
            // 1. Status Donut Chart
            const confirmedCount = rooms.filter(r => r.status === 'CONFIRMADO').length;
            const pendingCount = rooms.length - confirmedCount;

            const ctxStatus = document.getElementById('statusChart').getContext('2d');
            statusChart = new Chart(ctxStatus, {
                type: 'doughnut',
                data: {
                    labels: ['Confirmado', 'Pendiente'],
                    datasets: [{
                        data: [confirmedCount, pendingCount],
                        backgroundColor: ['#10b981', '#f87171'], // Emerald-500, Red-400
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: { position: 'bottom', labels: { usePointStyle: true, font: { family: 'Poppins', size: 12 } } }
                    }
                }
            });

            // 2. Occupancy Bar Chart
            const adults = rooms.reduce((s, r) => s + r.adults, 0);
            const kids = rooms.reduce((s, r) => s + r.kids, 0);
            const babies = rooms.reduce((s, r) => s + r.babies, 0);

            const ctxOcc = document.getElementById('occupancyChart').getContext('2d');
            occupancyChart = new Chart(ctxOcc, {
                type: 'bar',
                data: {
                    labels: ['Adultos', 'Niños', 'Bebés'],
                    datasets: [{
                        label: 'Total Huéspedes',
                        data: [adults, kids, babies],
                        backgroundColor: ['#0f172a', '#3b82f6', '#ec4899'], // Slate-900, Blue-500, Pink-500
                        borderRadius: 6,
                        barThickness: 40
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: { 
                            beginAtZero: true, 
                            grid: { display: true, borderDash: [2, 2], drawBorder: false } 
                        },
                        x: { 
                            grid: { display: false, drawBorder: false } 
                        }
                    }
                }
            });
        }

        // Initialize
        init();

    </script>
</body>
</html>